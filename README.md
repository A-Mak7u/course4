# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø–æ –¥–∞–Ω–Ω—ã–º MODIS LST –∏ ERA5 —Å –ø–æ–º–æ—â—å—é XGBoost

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é –Ω–∞–∑–µ–º–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã `T` –ø–æ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–º (MODIS LST) –∏ —Ä–µ–∞–Ω–∞–ª–∏–∑–Ω—ã–º (ERA5) –¥–∞–Ω–Ω—ã–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.  
–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –æ—Ü–µ–Ω–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (XGBoost) –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å –∏—Ö —Å –ª–∏–Ω–µ–π–Ω—ã–º–∏ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è–º–∏.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

- `eda.py` ‚Äî —Ä–∞–∑–≤–µ–¥–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö (EDA).
- `xgb_optuna_timesplit.py` ‚Äî –ø–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ XGBoost —á–µ—Ä–µ–∑ Optuna.
- `xgb_infer_full.py` ‚Äî –ø—Ä–æ–≥–æ–Ω –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ –≤—Å—ë–º –¥–∞—Ç–∞—Å–µ—Ç–µ.
- `shap_analysis.py` ‚Äî SHAP-–∞–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.
- `poly_regression_compare.py` ‚Äî –ª–∏–Ω–µ–π–Ω—ã–µ –∏ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏.
- `linear_regression_all_features.py` ‚Äî –ª–∏–Ω–µ–π–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–∞ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö.
- `eda_plots/` ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π.
- `outputs_runs/` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—É—Å–∫–æ–≤ (–≥—Ä–∞—Ñ–∏–∫–∏, –º–µ—Ç—Ä–∏–∫–∏, –º–æ–¥–µ–ª–∏).

---

## üîπ 1. –î–∞–Ω–Ω—ã–µ

- –ü–µ—Ä–∏–æ–¥: **2013‚Äì2023**, ~208 —Ç—ã—Å. —Å—Ç—Ä–æ–∫.  
- –ü—Ä–∏–∑–Ω–∞–∫–∏:
  - **ERA5**: `Temperature_2m`, `Dewpoint_2m`, `Surface_pressure`, `Evaporation`, `Total_precipitation`
  - **MODIS**: `LST_Day`, `LST_Night`
  - **–ù–∞–∑–µ–º–Ω—ã–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è**: `T`
  - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: `X_final`, `Y_final`

### –ü—Ä–æ–ø—É—Å–∫–∏
- `T` ‚Äî ~73%  
- `LST_Day`, `LST_Night` ‚Äî ~60% (–æ–±–ª–∞—á–Ω–æ—Å—Ç—å MODIS)  
- ERA5 ‚Äî ~12%  

---

## üîπ 2. –†–∞–∑–≤–µ–¥–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö (EDA)

- –ü–æ—Å—Ç—Ä–æ–µ–Ω—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, —Å–µ–∑–æ–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏, –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏.  
- –ù–∞–∏–±–æ–ª—å—à–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è —É —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `T` –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Å `Temperature_2m`, `Dewpoint_2m` –∏ `LST_Day`.

<p align="center">
  <img src="eda_plots/correlation_matrix.png" width="600">
</p>

**–í—ã–≤–æ–¥:** –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –≤—ã—Å–æ–∫—É—é –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é ERA5 `Temperature_2m` —Å `T`, –¥—Ä—É–≥–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (Evaporation, LST, Dewpoint) –≤–Ω–æ—Å—è—Ç –∑–Ω–∞—á–∏–º—ã–π –≤–∫–ª–∞–¥. –≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è SHAP-–∞–Ω–∞–ª–∏–∑–æ–º.

---

## üîπ 3. –£—á—ë—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞

–¢–∞–∫ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –∏–º–µ—é—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –≤–∞–∂–Ω–æ –±—ã–ª–æ –∏–∑–±–µ–∂–∞—Ç—å ¬´–ø–æ–¥—Å–º–∞—Ç—Ä–∏–≤–∞–Ω–∏—è –≤ –±—É–¥—É—â–µ–µ¬ª.

- **–û–±—É—á–µ–Ω–∏–µ (train):** 2013‚Äì2021  
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (test):** 2022‚Äì2023  
- –î–ª—è –ø–æ–¥–±–æ—Ä–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è KFold –≤–Ω—É—Ç—Ä–∏ train (2013‚Äì2021).  

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º–æ–¥–µ–ª—å –ø—Ä–æ–≤–µ—Ä—è–ª–∞—Å—å –Ω–∞ –±—É–¥—É—â–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ –≤—Ä–µ–º–µ–Ω–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —á–µ—Å—Ç–Ω—ã–º–∏.  

---

## üîπ 4. –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (XGBoost)

- –ü–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ Optuna (500 –∏—Ç–µ—Ä–∞—Ü–∏–π, GPU).  
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `tree_method = hist`, `device = cuda`.

### –ú–µ—Ç—Ä–∏–∫–∏ –Ω–∞ —Ç–µ—Å—Ç–µ (2022‚Äì2023)
R¬≤ = 0.9684
RMSE = 2.06 ¬∞C
MAE = 0.98 ¬∞C
MedAE= 0.60 ¬∞C


<p align="center">
  <img src="outputs_runs/20250905_142927/scatter_pred_vs_true.png" width="400">
  <img src="outputs_runs/20250905_142927/residuals_hist.png" width="400">
</p>

**–í—ã–≤–æ–¥:** –º–æ–¥–µ–ª—å –æ–±—ä—è—Å–Ω—è–µ—Ç ~97% –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —Å –æ—à–∏–±–∫–æ–π –º–µ–Ω–µ–µ 1 ¬∞C –≤ —Å—Ä–µ–¥–Ω–µ–º.

---

## üîπ 5. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ (SHAP-–∞–Ω–∞–ª–∏–∑)

SHAP-–∞–Ω–∞–ª–∏–∑ (–Ω–∞ –ø–æ–¥–≤—ã–±–æ—Ä–∫–µ 3000 —Å—Ç—Ä–æ–∫) –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ –≥–ª–∞–≤–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:

1. ERA5 `Temperature_2m`  
2. ERA5 `Evaporation`  
3. MODIS `LST_Day`  
4. ERA5 `Dewpoint_2m`  
5. MODIS `LST_Night`

<p align="center">
  <img src="shap_summary.png" width="500">
  <img src="shap_importance.png" width="500">
</p>

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
- –†–æ—Å—Ç `Temperature_2m` –∏ `LST_Day` –ø–æ–≤—ã—à–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `T`.  
- –í—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è `Evaporation` –∏–º–µ—é—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ (–æ–±—É—Å–ª–æ–≤–ª–µ–Ω–æ —Ñ–∏–∑–∏–∫–æ–π –ø—Ä–æ—Ü–µ—Å—Å–æ–≤: –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–µ –∏—Å–ø–∞—Ä–µ–Ω–∏–µ —á–∞—â–µ —Å–≤—è–∑–∞–Ω–æ —Å –ø–æ–Ω–∏–∂–µ–Ω–∏–µ–º –ø—Ä–∏–∑–µ–º–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã).  
- `Dewpoint_2m` –≤–Ω–æ—Å–∏—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –∏ —Ç–µ–ø–ª–æ–≤–æ–º –±–∞–ª–∞–Ω—Å–µ.  

---

## üîπ 6. –£—Ä–∞–≤–Ω–µ–Ω–∏—è –ø–µ—Ä–µ—Å—á—ë—Ç–∞

–î–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –ª–∏–Ω–µ–π–Ω—ã–µ –∏ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏.

### –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è (—Ç–æ–ø-5 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
T ‚âà 0.92 * Temperature_2m

1.02 * Evaporation

0.0013 * LST_Day

0.089 * Dewpoint_2m

1.23

- R¬≤ ‚âà 0.83

### –ü–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ (—Ç–æ–ø-9 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
- 1-—è —Å—Ç–µ–ø–µ–Ω—å ‚Üí R¬≤ ‚âà 0.83, 9 –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤  
- 2-—è —Å—Ç–µ–ø–µ–Ω—å ‚Üí R¬≤ ‚âà 0.92, 54 –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞  
- 3-—è —Å—Ç–µ–ø–µ–Ω—å ‚Üí R¬≤ ‚âà 0.93, 219 –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤  

<p align="center">
  <img src="poly_regression_comparison.png" width="500">
</p>

**–í—ã–≤–æ–¥:** —É—Å–ª–æ–∂–Ω–µ–Ω–∏–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–µ–∑–∫–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —á–∏—Å–ª–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤, –Ω–æ –ø–æ—á—Ç–∏ –Ω–µ –ø–æ–≤—ã—à–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å. XGBoost –æ—Å—Ç–∞—ë—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º –≤—ã–±–æ—Ä–æ–º.

---

## üîπ 7. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –≤—Å—ë–º –¥–∞—Ç–∞—Å–µ—Ç–µ (2013‚Äì2023)

–ü—Ä–æ–≥–æ–Ω –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö:

R¬≤ = 0.939
RMSE = 3.01 ¬∞C
MAE = 1.24 ¬∞C
MedAE= 0.53 ¬∞C
SMAPE= 5.6%

<p align="center">
  <img src="outputs_runs/20250905_142012/density_true_vs_pred.png" width="500">
</p>

### –ü–æ –≥–æ–¥–∞–º –∏ –º–µ—Å—è—Ü–∞–º
- R¬≤ —Å—Ç–∞–±–∏–ª—å–Ω–æ > 0.92 –ø–æ –≤—Å–µ–º –≥–æ–¥–∞–º.  
- –û—à–∏–±–∫–∏ –≤—ã—à–µ –∑–∏–º–æ–π (MODIS —á–∞—â–µ –∑–∞–∫—Ä—ã—Ç –æ–±–ª–∞–∫–∞–º–∏).  
- –ü–æ —Å—Ç–∞–Ω—Ü–∏—è–º –≤—ã—è–≤–ª–µ–Ω—ã –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ —Å –≤—ã—Å–æ–∫–∏–º RMSE.

---

## üìä –ò—Ç–æ–≥–∏

- –ú–æ–¥–µ–ª—å XGBoost –¥–æ—Å—Ç–∏–≥–∞–µ—Ç **R¬≤ ‚âà 0.97** –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–º —Ç–µ—Å—Ç–µ –∏ ~0.94 –Ω–∞ –≤—Å—ë–º –º–∞—Å—Å–∏–≤–µ.  
- SHAP-–∞–Ω–∞–ª–∏–∑ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª, —á—Ç–æ, –ø–æ–º–∏–º–æ `Temperature_2m`, –≤–∫–ª–∞–¥ –≤–Ω–æ—Å—è—Ç `Evaporation`, `LST_Day`, `Dewpoint_2m`.  
- –õ–∏–Ω–µ–π–Ω–∞—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è –æ–±—ä—è—Å–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ ~83% –¥–∏—Å–ø–µ—Ä—Å–∏–∏. –ü–æ–ª–∏–Ω–æ–º—ã –¥–∞—é—Ç –ø—Ä–∏—Ä–æ—Å—Ç, –Ω–æ —Ü–µ–Ω–æ–π —Å–æ—Ç–µ–Ω –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤.  
- –î–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–∞ **–Ω–µ–ª–∏–Ω–µ–π–Ω–∞—è –º–æ–¥–µ–ª—å**.  

---

## üìÇ –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏

- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç–∞—Ç—å–∏ (–æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –∂—É—Ä–Ω–∞–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ).  
- –í–æ–∑–º–æ–∂–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è QGIS-–ø–ª–∞–≥–∏–Ω–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ—Å—á—ë—Ç–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø–æ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º.  
