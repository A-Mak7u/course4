# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø–æ –¥–∞–Ω–Ω—ã–º MODIS LST –∏ ERA5 —Å –ø–æ–º–æ—â—å—é XGBoost

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ—Å–≤—è—â—ë–Ω –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é –Ω–∞–∑–µ–º–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –≤–æ–∑–¥—É—Ö–∞ `T` –ø–æ –¥–∞–Ω–Ω—ã–º –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–æ–≥–æ –∑–æ–Ω–¥–∏—Ä–æ–≤–∞–Ω–∏—è (MODIS LST) –∏ —Ä–µ–∞–Ω–∞–ª–∏–∑–∞ (ERA5).  
–ú—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—à–ª–∏ —ç—Ç–∞–ø—ã: –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö ‚Üí –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π ‚Üí –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è (SHAP, —É—Ä–∞–≤–Ω–µ–Ω–∏—è –ø–µ—Ä–µ—Å—á—ë—Ç–∞) ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –≤—Å—ë–º –º–∞—Å—Å–∏–≤–µ.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

- `eda.py` ‚Äî —Ä–∞–∑–≤–µ–¥–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö.  
- `xgb_optuna_timesplit.py` ‚Äî –ø–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ XGBoost —á–µ—Ä–µ–∑ Optuna.  
- `xgb_infer_full.py` ‚Äî –ø—Ä–æ–≥–æ–Ω –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ –≤—Å—ë–º –¥–∞—Ç–∞—Å–µ—Ç–µ.  
- `shap_analysis.py` ‚Äî SHAP-–∞–Ω–∞–ª–∏–∑ (–≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤).  
- `poly_regression_compare.py` ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ª–∏–Ω–µ–π–Ω—ã—Ö –∏ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã—Ö –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–π.  
- `linear_regression_all_features.py` ‚Äî –ª–∏–Ω–µ–π–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–∞ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö.  
- `eda_plots/` ‚Äî –≥—Ä–∞—Ñ–∏–∫–∏ —Ä–∞–∑–≤–µ–¥–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.  
- `outputs_runs/` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—É—Å–∫–æ–≤ –º–æ–¥–µ–ª–µ–π (–º–µ—Ç—Ä–∏–∫–∏, –≥—Ä–∞—Ñ–∏–∫–∏, –º–æ–¥–µ–ª–∏).  

---

## üîπ 1. –î–∞–Ω–Ω—ã–µ

- –ü–µ—Ä–∏–æ–¥: **2013‚Äì2023**, ~208 —Ç—ã—Å. —Å—Ç—Ä–æ–∫.  
- –ò—Å—Ç–æ—á–Ω–∏–∫–∏:  
  - ERA5: `Temperature_2m`, `Dewpoint_2m`, `Surface_pressure`, `Evaporation`, `Total_precipitation`  
  - MODIS: `LST_Day`, `LST_Night`  
  - –ù–∞–∑–µ–º–Ω—ã–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è: `T`  
  - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: `X_final`, `Y_final`

### –ü—Ä–æ–ø—É—Å–∫–∏
- `T` ‚Äî ~73%  
- MODIS (`LST_Day`, `LST_Night`) ‚Äî ~60% (–æ–±–ª–∞—á–Ω–æ—Å—Ç—å)  
- ERA5 ‚Äî ~12%  

---

## üîπ 2. –†–∞–∑–≤–µ–¥–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö (EDA)

–ú—ã –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ —Å–µ–∑–æ–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ (—Å–º. [–≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã](eda_plots/hist_Temperature_2m.png), [boxplots](eda_plots/boxplots.png), [—Å–µ–∑–æ–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã](eda_plots/temp_by_year.png), [–ø–æ –º–µ—Å—è—Ü–∞–º](eda_plots/temp_by_month.png)).  

–û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —É–¥–µ–ª–∏–ª–∏ **–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è–º**:

<p align="center">
  <img src="eda_plots/correlation_matrix.png" width="600">
</p>

–ö–∞–∫ –≤–∏–¥–Ω–æ, `Temperature_2m` –∏–∑ ERA5 —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å —Ü–µ–ª–µ–≤–æ–π `T`. –û–¥–Ω–∞–∫–æ –∏ –¥—Ä—É–≥–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Evaporation`, `LST_Day`, `Dewpoint_2m`) –æ–∫–∞–∑—ã–≤–∞—é—Ç –≤–ª–∏—è–Ω–∏–µ, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–æ—Å—å –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —ç—Ç–∞–ø–µ ‚Äî SHAP-–∞–Ω–∞–ª–∏–∑–µ.

---

## üîπ 3. –£—á—ë—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞

–¢–∞–∫ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ, –º—ã –∏–∑–±–µ–≥–∞–ª–∏ ¬´–ø–æ–¥—Å–º–∞—Ç—Ä–∏–≤–∞–Ω–∏—è –≤ –±—É–¥—É—â–µ–µ¬ª:  
- **–û–±—É—á–µ–Ω–∏–µ (train):** 2013‚Äì2021  
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (test):** 2022‚Äì2023  
- –í–Ω—É—Ç—Ä–∏ train –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—é.  

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Ç–µ—Å—Ç –ø–æ–ª—É—á–∏–ª—Å—è ¬´—á–µ—Å—Ç–Ω—ã–º¬ª ‚Äî –º–æ–¥–µ–ª—å –ø—Ä–æ–≤–µ—Ä—è–ª–∞—Å—å –Ω–∞ –±—É–¥—É—â–µ–º –ø–µ—Ä–∏–æ–¥–µ.

---

## üîπ 4. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (XGBoost)

–î–ª—è –ø–æ–¥–±–æ—Ä–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–∏–º–µ–Ω–∏–ª–∏ Optuna (500 –∏—Å–ø—ã—Ç–∞–Ω–∏–π). –û–±—É—á–µ–Ω–∏–µ –≤–µ–ª–æ—Å—å –Ω–∞ GPU (`device=cuda`).  

### –ú–µ—Ç—Ä–∏–∫–∏ –Ω–∞ —Ç–µ—Å—Ç–µ (2022‚Äì2023):
- R¬≤ = **0.9684**  
- RMSE = **2.06 ¬∞C**  
- MAE = **0.98 ¬∞C**  
- MedAE = **0.60 ¬∞C**  

–ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç –∫–∞—á–µ—Å—Ç–≤–æ:

<p align="center">
  <img src="outputs_runs/20250905_142927/scatter_pred_vs_true.png" width="400">
  <img src="outputs_runs/20250905_142927/residuals_hist.png" width="400">
</p>

–§–∞–∫—Ç –∏ –ø—Ä–æ–≥–Ω–æ–∑ –ª–µ–∂–∞—Ç –ø–æ—á—Ç–∏ –Ω–∞ –ª–∏–Ω–∏–∏ y=x, –æ—à–∏–±–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ –≤–æ–∫—Ä—É–≥ –Ω—É–ª—è.

---

## üîπ 5. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ (SHAP-–∞–Ω–∞–ª–∏–∑)

SHAP-–∞–Ω–∞–ª–∏–∑ (3000 —Å–ª—É—á–∞–π–Ω—ã—Ö —Ç–æ—á–µ–∫) –ø–æ–∫–∞–∑–∞–ª —Ç–æ–ø-5 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:

1. ERA5 `Temperature_2m`  
2. ERA5 `Evaporation`  
3. MODIS `LST_Day`  
4. ERA5 `Dewpoint_2m`  
5. MODIS `LST_Night`  

<p align="center">
  <img src="shap_summary.png" width="500">
  <img src="shap_importance.png" width="500">
</p>

üìå –ß—Ç–æ –≤–∏–¥–Ω–æ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö:  
- –í—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è `Temperature_2m` –∏ `LST_Day` —Ç—è–Ω—É—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤–≤–µ—Ä—Ö.  
- `Evaporation` –≤–Ω–æ—Å–∏—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ (—Ñ–∏–∑–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—á–Ω–æ: —Å–∏–ª—å–Ω–æ–µ –∏—Å–ø–∞—Ä–µ–Ω–∏–µ —á–∞—Å—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ–º –ø—Ä–∏–∑–µ–º–Ω–æ–≥–æ —Å–ª–æ—è).  
- `Dewpoint_2m` –æ—Ç—Ä–∞–∂–∞–µ—Ç –≤–ª–∞–∂–Ω–æ—Å—Ç—å –∏ –¥–æ–ø–æ–ª–Ω—è–µ—Ç –∫–∞—Ä—Ç–∏–Ω—É.

---

## üîπ 6. –£—Ä–∞–≤–Ω–µ–Ω–∏—è –ø–µ—Ä–µ—Å—á—ë—Ç–∞

–î–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏ –ø–æ—Å—Ç—Ä–æ–∏–ª–∏ —É–ø—Ä–æ—â—ë–Ω–Ω—ã–µ –ª–∏–Ω–µ–π–Ω—ã–µ –º–æ–¥–µ–ª–∏.

### –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è (—Ç–æ–ø-5 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
T ‚âà 0.92 * Temperature_2m

1.02 * Evaporation

0.0013 * LST_Day

0.089 * Dewpoint_2m

1.23

- R¬≤ ‚âà 0.83  

### –ü–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ (—Ç–æ–ø-9 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
- 1-—è —Å—Ç–µ–ø–µ–Ω—å ‚Üí R¬≤ ‚âà 0.83 (9 –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤)  
- 2-—è —Å—Ç–µ–ø–µ–Ω—å ‚Üí R¬≤ ‚âà 0.92 (54 –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞)  
- 3-—è —Å—Ç–µ–ø–µ–Ω—å ‚Üí R¬≤ ‚âà 0.93 (219 –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤)  

<p align="center">
  <img src="poly_regression_comparison.png" width="500">
</p>

**–í—ã–≤–æ–¥:** –ª–∏–Ω–µ–π–∫–∞ –æ–±—ä—è—Å–Ω—è–µ—Ç ~83% –¥–∏—Å–ø–µ—Ä—Å–∏–∏, –Ω–æ —É—Å–ª–æ–∂–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª—ã –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å–æ—Ç–Ω—è–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º –ø—Ä–∏—Ä–æ—Å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–∞. –≠—Ç–æ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π.

---

## üîπ 7. –ü—Ä–æ–≥–æ–Ω –º–æ–¥–µ–ª–∏ –Ω–∞ –≤—Å—ë–º –¥–∞—Ç–∞—Å–µ—Ç–µ (2013‚Äì2023)

–ß—Ç–æ–±—ã –æ—Ü–µ–Ω–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, –ø—Ä–æ–≥–Ω–∞–ª–∏ –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –Ω–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö.  

### –ú–µ—Ç—Ä–∏–∫–∏:
- R¬≤ = **0.939**  
- RMSE = **3.01 ¬∞C**  
- MAE = **1.24 ¬∞C**  
- MedAE = **0.53 ¬∞C**  
- SMAPE = **5.6%**

<p align="center">
  <img src="outputs_runs/20250905_142012/density_true_vs_pred.png" width="500">
</p>

–†–∞–∑–±–∏–≤–∫–∏ –ø–æ –≥–æ–¥–∞–º –∏ –º–µ—Å—è—Ü–∞–º (—Å–º. `metrics_by_year.csv`, `metrics_by_month.csv`) –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ –∫–∞—á–µ—Å—Ç–≤–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤—ã—à–µ 0.92. –ù–µ–º–Ω–æ–≥–æ —Ö—É–∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∏–º–æ–π, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ MODIS —á–∞—Å—Ç–æ –∑–∞–∫—Ä—ã—Ç—ã –æ–±–ª–∞–∫–∞–º–∏.  
–ü–æ —Å—Ç–∞–Ω—Ü–∏—è–º (—Å–º. `metrics_by_station.csv`) –≤—ã–¥–µ–ª—è—é—Ç—Å—è —Ç–æ—á–∫–∏ —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º RMSE ‚Äî –∏—Ö —Å—Ç–æ–∏—Ç —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ.

---

## üìä –ò—Ç–æ–≥–∏

- XGBoost –¥–∞—ë—Ç **R¬≤ ‚âà 0.97** –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–º —Ç–µ—Å—Ç–µ –∏ ~0.94 –Ω–∞ –≤—Å—ë–º –º–∞—Å—Å–∏–≤–µ.  
- SHAP –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ –∫—Ä–æ–º–µ ERA5 `Temperature_2m`, –≤–∞–∂–Ω—ã `Evaporation`, `LST_Day`, `Dewpoint_2m`.  
- –õ–∏–Ω–µ–π–Ω—ã–µ —Ñ–æ—Ä–º—É–ª—ã —É–¥–æ–±–Ω—ã –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏, –Ω–æ –∏—Ö —Ç–æ—á–Ω–æ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ (83%).  
- –£—Å–ª–æ–∂–Ω–µ–Ω–∏–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –Ω–µ –¥–∞—ë—Ç –∞–¥–µ–∫–≤–∞—Ç–Ω–æ–≥–æ –ø—Ä–∏—Ä–æ—Å—Ç–∞ ‚Äî –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ –º–æ–¥–µ–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ.  

---

## üìÇ –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏

- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç–∞—Ç—å–∏/–∫—É—Ä—Å–æ–≤–æ–π –Ω–∞ –±–∞–∑–µ —ç—Ç–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.  
- –í–æ–∑–º–æ–∂–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è QGIS-–ø–ª–∞–≥–∏–Ω–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ—Å—á—ë—Ç–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø–æ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º.
